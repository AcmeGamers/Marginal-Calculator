<!-- Developer Notes 1:
  
- Creating a side bar icon which opens a side bar tab whose main function is to work like a smol wiki having 
two tabs, one is example of usage and how it works.

- Another thing is to make the width 30% and make area outside of the side dark when opened. 
-- (Give an option to make it normal for people having issues).

- Click outside should close the window or make it hidden.
-- a pin button can be used to pin it so it doesn't gives issues with clicking outside of the area

-->
<!-- Developer Notes 2:

- Functions will have their own seperate JS file.
-- Wellll, I will think about it 

-->
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Marginal Calculator</title>
    <link rel="stylesheet" href="app.css" />
    <link rel="stylesheet" href="components/tabs.css" />
    <link rel="icon" type="image/x-icon" href="components/favicon-1.ico" />
  </head>
  <body>
    <div class="se-pre-con"></div>
    <div style="margin: 0 0 1rem">
      <h2>Calculator</h2>
      <!-- use storage session check if there is a session. -->
      <span>
        Cache Clear in case of new commit/change
        <button onclick="window.location.reload(true)">Clear</button>
      </span>
    </div>
    <!-- <div class="side_bar_tab"></div> -->
    <div id="tabs">
      <div class="tab">
        <button
          class="tablinks"
          onclick="openTab(event, 'Marginal_Revenue_Tab')"
        >
          Marginal Revenue
        </button>
        <button class="tablinks" onclick="openTab(event, 'PED')">
          Price Elasticity of Demand (PED)
        </button>
        <button class="tablinks" onclick="openTab(event, 'YED')">
          Income Elasticity of Demand (YED)
        </button>
        <button class="tablinks" onclick="openTab(event, 'XED')">
          Cross Price Elasticity of Demand (XED)
        </button>
        <button class="tablinks" onclick="openTab(event, 'PC')">
          Students' Tab
        </button>
      </div>

      <!-- Marginal Revenue (MR) -->
      <div id="Marginal_Revenue_Tab" class="tabcontent">
        <div class="text_and_input">
          <p class="margin-right-1rem">Expression</p>
          <input
            type="text"
            value="49 + 8*q + 6*Q^2"
            placeholder="49 + 8*q + 6*Q^2"
            id="expression"
          />
        </div>

        <!-- 55 + 6*q - 7*q^2 + 3*q^3 === Q = 4 === 94 -->
        <div class="text_and_input">
          <p class="margin-right-1rem">Value of Q:</p>
          <input type="text" value="9" placeholder="Value of Q" id="q_value" />
        </div>

        <button style="margin-top: 6px" type="button" onclick="MRCheck()">
          Calculate!
        </button>

        <div id="mr1" class="left-align">
          <h2 id="derivation_h2"></h2>
          <p id="derivative_step1" class="hide"></p>
          <p id="derivative_step1_2" class="no-margin"></p>
          <p id="derivative_step2" class="hide"></p>
          <p id="derivative_step2_2" class="no-margin"></p>
        </div>

        <div id="mr2" class="left-align">
          <h2 id="puttingValues_h2"></h2>
          <p id="puttingValues_step1" class="hide"></p>
          <p id="puttingValues_step1_1" class="no-margin"></p>
          <p id="puttingValues_step1_2" class="no-margin"></p>
          <p id="puttingValues_step2" class="hide"></p>
          <p id="puttingValues_step2_1" class="no-margin"></p>
          <span id="result"></span>
        </div>

        <div id="mr3" class="left-align">
          <h2 id="Marginal_Conclusion_1"></h2>
          <span id="Marginal_Conclusion_2"></span>
        </div>
      </div>

      <!-- Price Elasticity of Demand (PED) -->
      <div id="PED" class="tabcontent">
        <div>
          <h1 style="font-size: 20px">Price Elasticity of Demand (PED)</h1>

          <!-- Need of Values -->
          <div id="checkPEDRequirements">
            <span> Do you need to take out: </span>

            <label id="ped_1_1">
              <input type="checkbox" value="1" name="status" />
              YED
            </label>
            <label id="ped_1_2">
              <input type="checkbox" value="1" name="status" />
              XED
            </label>
            <label id="ped_1_3">
              <input type="checkbox" value="1" name="status" />
              Percentage Change
            </label>
          </div>
          <!-- HTML Selector: 1, 2, 3 -->
          <div id="observe_ped_change">
            <span>Price Goods Limit:</span>

            <label>
              <input type="radio" value="1" id="ped_1" name="status" />
              1
            </label>

            <label>
              <input type="radio" value="2" id="ped_2" name="status" />
              2
            </label>
            <label>
              <input type="radio" value="3" id="ped_3" name="status" />
              3
            </label>
          </div>
          <div>
            <!-- PED Expression -->
            <span class="margin-right-1rem">Expression</span>
            <input
              type="text"
              style="width: 50vw"
              value="4850 - 5 * p1 + 1.5 * p2 + 0.1 * y"
              placeholder="1456 - P1 + 0.75 * P2 - 0.5 * p3 + 0.05*Y"
              id="ped_expression"
            />
          </div>
          <!-- 700-2*p+0.02*y -->
          <!-- 5000 -->
          <!-- One P Value Holder-->

          <!-- Two P Value Holder-->
          <!-- "4850 - 5 * p1 + 1.5 * p2 + 0.1 * y" -->

          <!-- Three P Value Holder-->
          <!-- "1456 - P1 + 0.75 * P2 - 0.5 * p3 + 0.05*Y" -->
          <!-- 18361 -->

          <div
            style="
              display: flex;
              flex-direction: column;
              align-items: flex-start;
            "
          >
            <!-- PED Goods Result -->
            <div id="PED_goods" style="display: block; margin: 1rem 0">
              <span id="ped_result"></span>
            </div>
            <div
              style="display: flex; flex-direction: row; align-items: baseline"
            >
              <!-- PED Income (Y) -->
              <p class="margin-right-1rem" style="margin-top: 0">Income (Y)</p>
              <input
                id="ped_income"
                value="18361"
                type="text"
                placeholder="Income"
              />
            </div>

            <!-- PED Calculate -->
            <button style="margin: 1rem 0" type="button" onclick="PEDCheck()">
              Calculate!
            </button>
          </div>

          <!-- PED Answer Display -->
          <div id="ped1" class="left-align">
            <h2 id="ped_find_q"></h2>
            <p id="ped_calculate_step1" class="hide"></p>
            <p id="ped_calculate_step1_1" class="no-margin"></p>
            <p id="ped_calculate_step1_2" class="no-margin"></p>
            <p id="ped_calculate_step1_3" class="no-margin"></p>
          </div>

          <div id="ped2" class="left-align">
            <h2 id="ped_find_dev"></h2>
            <p id="ped_deviation_1" class="hide"></p>
            <p id="ped_deviation_1_1" class="no-margin"></p>
            <p id="ped_deviation_1_2" class="no-margin"></p>
            <p id="ped_deviation_1_3" class="no-margin"></p>
          </div>

          <div id="ped3" class="left-align">
            <h2 id="find_ped"></h2>
            <p id="find_ped_1" class="hide"></p>
            <p id="find_ped_1_1" class="no-margin"></p>
            <p id="find_ped_1_2" class="no-margin"></p>
            <p id="find_ped_1_3" class="no-margin"></p>
          </div>

          <div id="ped4" class="left-align">
            <h2 id="ped_result_h2"></h2>
            <p id="ped_result_1" class="hide"></p>
            <p id="ped_result_1_1" class="no-margin"></p>
            <p id="ped_result_1_2" class=""></p>
          </div>

          <div class="if_active_yed">
            <div id="ped5-yed" class="left-align">
              <h2 id="ped5-yed-h2"></h2>
              <p id="ped5-yed-1" class="hide"></p>
              <p id="ped5-yed-1_1" class="no-margin"></p>
              <p id="ped5-yed-1_2" class="no-margin"></p>
              <p id="ped5-yed-1_3" class="no-margin"></p>
            </div>
          </div>
          <div class="if_active_xed">
            <div id="ped6-yed" class="left-align">
              <h2 id="ped6-yed-1"></h2>
              <p id="ped6-yed-1_1" class="hide"></p>
              <p id="ped6-yed-1_2" class="no-margin"></p>
              <p id="ped6-yed-1_3" class=""></p>
            </div>
          </div>
        </div>
      </div>

      <div id="YED" class="tabcontent">
        <h3>YED</h3>
        <p>YED will be arriving soon from rest.</p>
      </div>

      <div id="XED" class="tabcontent">
        <h3>XED</h3>
        <p>
          XED will be arriving soon from a lonnnnnng breakfast (that is until
          the dev ends making this one).
        </p>
      </div>

      <div id="PC" class="tabcontent">
        <div>
          <h3>Students' Tab</h3>
          <p>
            Alpha feature of the calculator which is made for the use of finding
            PED, YED, XED, and Percent Change.
          </p>
        </div>

        <!-- PED Expression -->
        <span class="margin-right-1rem">Expression</span>
        <input
          type="text"
          style="width: 50vw"
          value="4850 - 5 * p1 + 1.5 * p2 + 0.1 * y"
          placeholder="1456 - P1 + 0.75 * P2 - 0.5 * p3 + 0.05*Y"
          id="student_expression"
        />
        <div class="text_and_input style='margin: 10px 0 0 1rem'">
          <p class="margin-right-1rem">Pay of Goods 1 (P1)</p>
          <input
            ng-pattern="/^\d+$/"
            id="pog1"
            value="209"
            type="number"
            placeholder="Price of Good 1"
          />
        </div>
        <div class="text_and_input">
          <p class="margin-right-1rem">Pay of Goods 2 (P2)</p>
          <input
            ng-pattern="/^\d+$/"
            id="pog2"
            value="101"
            type="number"
            placeholder="Price of Good 2"
          />
        </div>
        <div class="text_and_input">
          <p class="margin-right-1rem">Pay of Goods 3 (P3)</p>
          <input
            ng-pattern="/^\d+$/"
            id="pog3"
            value="478"
            type="number"
            placeholder="Price of Good 3"
          />
        </div>

        <div class="text_and_input">
          <!-- PED Income (Y) -->
          <p class="margin-right-1rem">Income (Y)</p>
          <input
            id="student_income"
            type="number"
            value="18361"
            placeholder="Income"
            ng-pattern="/^\d+$/"
          />
        </div>
        <!-- Select Options for Percent Change -->
        <h3>Percent Change</h3>
        <div
          style="display: flex; flex-direction: row; align-items: flex-start"
        >
          <p>
            Select the goods to compare:
            <select name="good1" id="good1">
              <option value="good 1">Goods 1</option>
              <option value="good 2">Goods 2</option>
              <option value="good 3">Goods 3</option>
            </select>

            <select name="good2" id="good2">
              <option value="good 1">Goods 1</option>
              <option value="good 2">Goods 2</option>
              <option value="good 3">Goods 3</option>
            </select>
          </p>
        </div>
        <div
          style="display: flex; flex-direction: row; align-items: flex-start"
        >
          <p>
            And was there a decrease or increase:
            <select name="decreaseOrIncrease" id="decreaseOrIncrease">
              <option value="+">Increase</option>
              <option value="-">Decrease</option>
            </select>
          </p>
        </div>
        <div
          style="display: flex; flex-direction: row; align-items: flex-start"
        >
          <p>
            Then by how much percent?

            <input
              value="5"
              type="number"
              style="width: 50px"
              class="input-percent"
              id="percent"
            />
            <span>%</span>
          </p>
        </div>
        <!-- PED Calculate -->
        <button
          style="margin: 1rem 0"
          type="button"
          onclick="StudentValuesCheck()"
        >
          Calculate!
        </button>

        <!--  -->
        <!-- Answers -->
        <!-- Part 1 -->
        <div id="students_tab_1" class="left-align">
          <hr />
          <span id="part_1_PED_h2"></span>
          <span id="part_1_PED-1_hide" class="hide"></span>
          <span id="part_1_PED-1-1" class="px-10-ud"></span>
          <span id="part_1_PED-1-2" class="px-10-ud"></span>
          <span id="part_1_PED-1-3" class="px-10-ud"></span>
          <span id="part_1_PED-1-4" class="px-10-ud"></span>
          <span id="part_1_PED-1-5" class="px-10-ud"></span>
          <span id="part_1_PED-1-6" class="px-10-ud"></span>
          <span id="part_1_PED-1-7" class="px-10-ud"></span>
          <span id="part_1_PED-1-8" class="px-10-ud"></span>
          <span id="part_1_PED-1-9" class="px-10-ud"></span>
          <span id="part_1_PED-1-10" class="px-10-ud"></span>
          <span id="part_1_PED-1-11" class="px-10-ud"></span>
        </div>

        <!-- Part 2 -->
        <div id="students_tab_2" class="left-align">
          <hr />
          <span id="part_2_YED_h2"></span>
          <span id="part_2_YED-1_hide" class="hide"></span>
          <span id="part_2_YED-1-1" class="px-10-ud"></span>
          <span id="part_2_YED-1-2" class="px-10-ud"></span>
          <span id="part_2_YED-1-3" class="px-10-ud"></span>
          <span id="part_2_YED-1-4" class="px-10-ud"></span>
          <span id="part_2_YED-1-5" class="px-10-ud"></span>
          <span id="part_2_YED-1-6" class="px-10-ud"></span>
          <span id="part_2_YED-1-7" class="px-10-ud"></span>
          <span id="part_2_YED-1-8" class="px-10-ud"></span>
          <span id="part_2_YED-1-9" class="px-10-ud"></span>
        </div>

        <!-- Part 3 -->
        <div id="students_tab_3" class="left-align">
          <hr />
          <span id="part_3_XED_h2"></span>
          <span id="part_3_XED_hide" class="hide"></span>
          <span id="part_3_XED_1" class="px-10-ud"></span>
          <span id="part_3_XED_2" class="px-10-ud"></span>
          <span id="part_3_XED_3" class="px-10-ud"></span>
          <span id="part_3_XED_4" class="px-10-ud"></span>
          <span id="part_3_XED_5" class="px-10-ud"></span>
          <span id="part_3_XED_6" class="px-10-ud"></span>
          <span id="part_3_XED_7" class="px-10-ud"></span>
          <span id="part_3_XED_8" class="px-10-ud"></span>
        </div>

        <!-- Part 4 -->
        <div id="students_tab_4" class="left-align">
          <hr />
          <span id="part_4_XED_h2"></span>
          <span id="part_4_XED_hide" class="hide"></span>
          <span id="part_4_XED_1" class="px-10-ud"></span>
          <span id="part_4_XED_2" class="px-10-ud"></span>
          <span id="part_4_XED_3" class="px-10-ud"></span>
          <span id="part_4_XED_4" class="px-10-ud"></span>
          <span id="part_4_XED_5" class="px-10-ud"></span>
          <span id="part_4_XED_6" class="px-10-ud"></span>
          <span id="part_4_XED_7" class="px-10-ud"></span>
          <span id="part_4_XED_8" class="px-10-ud"></span>
        </div>

        <!-- Part 5 -->
        <div id="students_tab_5" class="left-align">
          <hr />
          <span id="part_5_percent_change_h2"></span>
          <span id="part_5_percent_change_hide" class="hide"></span>
          <span id="part_5_percent_change_1" class="px-10-ud"></span>
          <span id="part_5_percent_change_2" class="px-10-ud"></span>
          <span id="part_5_percent_change_3" class="px-10-ud"></span>
          <span id="part_5_percent_change_4" class="px-10-ud"></span>
          <span id="part_5_percent_change_5" class="px-10-ud"></span>
          <span id="part_5_percent_change_6" class="px-10-ud"></span>
          <span id="part_5_percent_change_7" class="px-10-ud"></span>
          <span id="part_5_percent_change_8" class="px-10-ud"></span>
          <span id="part_5_percent_change_9" class="px-10-ud"></span>
          <span id="part_5_percent_change_10" class="px-10-ud"></span>
          <span id="part_5_percent_change_11" class="px-10-ud"></span>
          <span id="part_5_percent_change_12" class="px-10-ud"></span>
          <span id="part_5_percent_change_13" class="px-10-ud"></span>
        </div>
      </div>
    </div>

    <!-- Footer -->
    <footer>
      <div>
        <p>
          A github repository created by
          <a href="https://github.com/AcmeGamers">Acme Gamers</a>
        </p>
      </div>
    </footer>
  </body>

  <!-- Nerdamer -->
  <script src="https://cdn.jsdelivr.net/npm/nerdamer@1.1.12/nerdamer.core.min.js"></script>
  <script
    src="https://cdn.jsdelivr.net/npm/nerdamer@1.1.12/Algebra.js"
    integrity="sha256-oJEHFFp8pDXx0Myx6cc7RVmh3a2kZPEGOP+bAunJptU="
    crossorigin="anonymous"
  ></script>
  <script
    src="https://cdn.jsdelivr.net/npm/nerdamer@1.1.12/Calculus.js"
    integrity="sha256-1X0hl2yReR/yZuZo7R3A9LUgS9+zWl8GzYjuk4pd6bE="
    crossorigin="anonymous"
  ></script>

  <!-- Math JS -->
  <script src="https://cdn.jsdelivr.net/npm/mathjs@10.0.0/lib/browser/math.min.js"></script>

  <!-- Katex -->
  <link
    rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css"
    integrity="sha384-R4558gYOUz8mP9YWpZJjofhk+zx0AS11p36HnD2ZKj/6JR5z27gSSULCNHIRReVs"
    crossorigin="anonymous"
  />

  <!-- Math Quill -->
  <link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/mathquill/0.9.1/mathquill.min.css"
    integrity="sha512-ClJLWtbX5z9xE5ZeKRcTGB+nJGP32tjiM75BMsvTYbl1L93KDrtK3SNVtJnv0lpIyv6G/JqD4ovPr7NxdeZVBA=="
    crossorigin="anonymous"
    referrerpolicy="no-referrer"
  />
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
  <script
    src="https://cdnjs.cloudflare.com/ajax/libs/mathquill/0.9.1/mathquill.min.js"
    integrity="sha512-nrkcp3u2ytFW9WsmuD0JwlIhY6ZDCfL8+vd9cofdsl7m4XvmCR+DCvhvq0Zuhg69rGLsASKfYgcJKvyh6dyf0A=="
    crossorigin="anonymous"
    referrerpolicy="no-referrer"
  ></script>
  <script>
    // var MQ = MathQuill.getInterface(2);
  </script>

  <!-- The loading of KaTeX is deferred to speed up page rendering -->
  <script
    defer
    src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js"
    integrity="sha384-z1fJDqw8ZApjGO3/unPWUPsIymfsJmyrDVWC8Tv/a1HeOtGmkwNd/7xUS0Xcnvsx"
    crossorigin="anonymous"
  ></script>

  <!-- To automatically render math in text elements, include the auto-render extension: -->
  <script
    defer
    src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/contrib/auto-render.min.js"
    integrity="sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR"
    crossorigin="anonymous"
    onload="renderMathInElement(document.body);"
  ></script>

  <!-- My Scripts -->
  <script src="altogether.js"></script>
  <script>
    function openTab(evt, cityName) {
      var i, tabcontent, tablinks;
      tabcontent = document.getElementsByClassName("tabcontent");
      for (i = 0; i < tabcontent.length; i++) {
        tabcontent[i].style.display = "none";
      }
      tablinks = document.getElementsByClassName("tablinks");
      for (i = 0; i < tablinks.length; i++) {
        tablinks[i].className = tablinks[i].className.replace(" active", "");
      }
      document.getElementById(cityName).style.display = "block";
      evt.currentTarget.className += " active";
    }
  </script>

  <!-- Custom Functions / Scripts  -->
  <script>
    document.onreadystatechange = () => {
      if (document.readyState === "complete") {
        document.querySelector(".se-pre-con").style.display = "none";
      }
    };
    var select_value;
    // Add Custom Style Property
    function hideToShow(name, value, repeat) {
      try {
        if (repeat > 0) {
          for (var data = 1; data <= repeat; data++) {
            document.getElementById(name + data).style.display = value;
          }
          console.log("Complete");
        } else {
          log(
            `The repeat is given less than 1, current value of repeat: ${repeat}`
          );
        }
      } catch (error) {
        console.log(`There is some error in the user input`);
      }
    }
    // Latex Function
    function LatexValue(id, nerdamerExpression, TheElement, data) {
      // Renders data
      document.getElementById(id).innerHTML = katex.render(
        data + `=  ${nerdamer.expressions(true, "LaTeX")[nerdamerExpression]}`,
        document.getElementById(TheElement),
        {
          displayMode: true,
          macros: {
            "\\RR": "\\mathbb{R}",
          },
        }
      );
    }

    // Latex Function Without Nerdamer
    function LatexValue_WithoutNerdamer(id, expressionValue, TheElement, data) {
      document.getElementById(id).innerHTML = katex.render(
        data + `=  ${expressionValue}`,
        document.getElementById(TheElement),
        {
          displayMode: true,
          macros: {
            "\\RR": "\\mathbb{R}",
          },
        }
      );
    }

    // Each Value Checker
    function valueCheck(dataExpression) {
      // Split using a space character
      let arr = dataExpression.split(" ");

      // Making the Array
      var value1 = [];
      for (let index = 0; index < arr.length; index++) {
        value1 += `${arr[index]} `;
      }

      // Result
      var finalAnswer = eval(math.evaluate(value1));
      console.log(value1);
      console.log(finalAnswer);

      answers = {
        derivative: deriveExpression(expressionValue),
        puttingValues: value1,
        answer: finalAnswer,
      };
      return answers;
    }

    // Marginal Revenue Function
    function MRCheck() {
      hideToShow("mr", "flex", 3);

      // Obtaining Input Value
      var expression = document
        .getElementById("expression")
        .value.toLowerCase()
        .replace(/q/g, "x"); // This line replaces any `x` variable with `q`

      // Logs The Result
      console.log(expression);
      var q_value = document.getElementById("q_value").value; // Gets Value of Q

      // Marginal Revenue Calculation
      function MarginalRevenue(expression, Q) {
        // Obtaining the Expression from first Function
        var expressionValue = expression,
          deviationResult = deriveExpression(expressionValue),
          result = deviationResult.replace(/x/g, Q);
        console.log(deviationResult);

        // Split using a space character
        let arr = result.split(" ");

        // Making the Array
        var value1 = [];
        for (let index = 0; index < arr.length; index++) {
          value1 += `${arr[index]} `;
        }

        // Result
        var finalAnswer = eval(math.evaluate(value1));
        console.log(value1);
        console.log(finalAnswer);

        // Providing the answers to variables which needs it.
        answers = {
          derivative: deriveExpression(expressionValue),
          puttingValues: value1,
          answer: finalAnswer,
        };
        console.log("-------------------");
        return answers;
      }

      // Marginal Revenue Function Calculation 2
      function MarginalRevenueDisplay() {
        var result = MarginalRevenue(expression, q_value);

        // Derivation
        document.getElementById("derivation_h2").innerHTML =
          "Step 1: Derivation";

        var element = "derivative_step1_2";
        var firstNearDream = nerdamer(`d/dQ(${expression.replace(/x/g, "Q")})`);
        LatexValue("derivative_step1", "1", element, "MR ");

        element = "derivative_step2_2";
        var secondNearDream = nerdamer(
          `${result.derivative.replace(/x/g, "Q")}`
        );
        LatexValue("derivative_step2", "2", element, "MR ");

        // Putting Values
        document.getElementById("puttingValues_h2").innerHTML =
          "Step 2: Putting Values";

        // puttingValues_step1_2
        element = "puttingValues_step1_1";
        var thirdNearDream = nerdamer(`${q_value}`);
        LatexValue("puttingValues_step1", "3", element, "Value of Q");

        // puttingValues_step1_1
        element = "puttingValues_step1_2";
        var secondNearDream = nerdamer(`${result.derivative}`);
        LatexValue("puttingValues_step1", "2", element, "MR ");

        // puttingValues_step2_1
        element = "puttingValues_step2_1";
        LatexValue_WithoutNerdamer(
          "puttingValues_step2",
          result.puttingValues,
          element,
          `MR `
        );

        // Results
        document.getElementById("result").innerHTML = `MR = ${result.answer}`;

        // Conclusion
        document.getElementById("Marginal_Conclusion_1").innerHTML =
          "Conclusion";
        document.getElementById(
          "Marginal_Conclusion_2"
        ).innerHTML = `Hence the revenue of ${q_value} units is $${result.answer}`;

        nerdamer.flush();
      }
      // Function that displays values on HTML page
      try {
        MarginalRevenueDisplay();
      } catch (error) {
        document.getElementById("result").innerHTML =
          "There is some issue in the formula or the typed data is invalid";
        console.log(error);
      }
    }
    // <!-- Script for PED -->

    // <!-- Script to change Price good limits -->

    var result = document.querySelector("#ped_result");
    document
      .querySelector("#observe_ped_change")
      .addEventListener("change", function (e) {
        var target = e.target;
        var data;
        switch (target.value) {
          case "1":
            data = `<div class="text_and_input"><p class="margin-right-1rem">Pay of Goods 1 (P)</p><input id="pg1"value="25"type="text"placeholder="Price of Good 1"/></div>`;
            hideToShow();
            document.querySelector("#ped_1_2").style.visibility = "hidden";
            document.querySelector("#ped_1_3").style.visibility = "hidden";
            break;
          case "2":
            data = `<div class="text_and_input"><p class="margin-right-1rem">Pay of Goods 1 (P1)</p><input id="pg1"value="209"type="text"placeholder="Price of Good 1"/></div><div class="text_and_input"><p class="margin-right-1rem">Pay of Goods 2 (P2)</p><input id="pg2"value="101"type="text"placeholder="Price of Good 2"/></div>`;
            document.querySelector("#ped_1_2").style.visibility = "initial";
            document.querySelector("#ped_1_3").style.visibility = "initial";
            break;
          case "3":
            data = `<div class="text_and_input"><p class="margin-right-1rem">Pay of Goods 1 (P1)</p><input id="pg1"value="209"type="text"placeholder="Price of Good 1"/></div><div class="text_and_input"><p class="margin-right-1rem">Pay of Goods 2 (P2)</p><input id="pg2"value="101"type="text"placeholder="Price of Good 2"/></div><div class="text_and_input"><p class="margin-right-1rem">Pay of Goods 3 (P3)</p><input id="pg3"value="478"type="text"placeholder="Price of Good 3"/></div>`;
            document.querySelector("#ped_1_2").style.visibility = "hidden";
            document.querySelector("#ped_1_3").style.visibility = "hidden";
            hideToShow();
            break;
        }
        console.log(e.target.defaultValue);
        select_value = e.target.defaultValue;
        result.innerHTML = data;
      });

    // <!-- PED, YED, XED Calculator -->

    ////////////
    // Functions
    ////////////
    // Variable Replacer
    function variableReplacer(
      expression,
      valueToChange,
      value1,
      valueToChange2,
      value2,
      valueToChange3,
      value3,
      value4,
      valueToChange4
    ) {
      var result;

      if (value4) {
        result = expression.split(valueToChange).join(value1);
        result = result.split(valueToChange2).join(value2);
        result = result.split(valueToChange3).join(value3);
        result = result.split(valueToChange4).join(value4);
        return result;
      } else if (value3) {
        result = expression.split(valueToChange).join(value1);
        result = result.split(valueToChange2).join(value2);
        result = result.split(valueToChange3).join(value3);
        return result;
      } else if (value2) {
        result = expression.split(valueToChange).join(value1);
        result = result.split(valueToChange2).join(value2);
        return result;
      } else {
        result = expression.split(valueToChange).join(value1);
        return result;
      }
    }
    // Expression Spliter
    function expressionSpliter(expression) {
      // Split using a space character
      let arr = expression.split(" ");

      // Making the Array
      var array = [];
      for (let index = 0; index < arr.length; index++) {
        array += `${arr[index]} `;
      }
      console.log("Hello, The array is complete! " + array);
      return array;
    }

    // Q Finder
    function Q_Checker(expression) {
      var q_array = expressionSpliter(expression);
      // var q_result = eval(math.evaluate(q_array));
      var q_result = eval(q_array);
      console.log(q_array);
      console.log(q_result);

      var answers = {
        puttingValues: q_array,
        answer: q_result,
      };
      return answers;
    }

    function checkPED(value) {
      var comment, is_Q, data;
      if (value < 1) {
        comment = `Since the value is less than 1, (${value} < 1), demand is inelastic.`;
        is_Q = `Q is a necessary good`;
        data = {
          comment: comment,
          is_Q: is_Q,
        };
        return data;
      }
      if (value > 1) {
        comment = `Since the value is greater than 1, (${value} > 1), demand is elastic.`;
        is_Q = `Q is a demanding good`;
        data = {
          comment: comment,
          is_Q: is_Q,
        };
        return data;
      } else {
        comment = `Since the value is equal to 1, (${value} = 1), demand is unitary`;
        is_Q = `Demand for Q does not change in response to price.`;
        data = {
          comment: comment,
          is_Q: is_Q,
        };
        return data;
      }
    }

    function checkYED(value) {
      var comment, elasticity, data;
      if (value < 1) {
        comment = `Since the value is less than 1, (${value} < 1). It is a necessary good.`;
        elasticity = `Such that, Income Elasticity is <b>Low Income Elasticity</b> having <b>necessary goods</b> from Normal Goods.`;
        data = {
          comment: comment,
          elasticity: elasticity,
        };
        return data;
      }
      if (value > 1) {
        comment = `Since the value is greater than 1, (${value} > 1). This is typical of a luxury or superior good.`;
        elasticity = `Such that, Income Elasticity is <b>High Income Elasticity</b> having <b>superior goods</b> from Normal Goods.`;
        data = {
          comment: comment,
          elasticity: elasticity,
        };
        return data;
      }
      if (value == 1) {
        comment = `Since the value is equal to 1, (${value} = 1). Proportional increase in price and goods.`;
        elasticity = `Such that, Income Elasticity is <b>Unitary Income Elasticity</b> having no change.`;
        data = {
          comment: comment,
          elasticity: elasticity,
        };
        return data;
      }
      if (value == 0) {
        comment = `Since the value is equal to 0, (${value} = 0). Change in income has no effect over the bought quantity`;
        elasticity = `Such that, Income Elasticity is <b>Zero Income Elasticity</b> having <b>Sticky goods</b> from Normal Goods.`;
        data = {
          comment: comment,
          elasticity: elasticity,
        };
        return data;
      } else {
        comment = `Since the value is less than 0, (${value} > 0), it is an inferior goods, unlike others which are normal goods.`;
        elasticity = `Such that, Income Elasticity is <b>Negative Income Elasticity</b> inferior from Normal Goods.`;
        data = {
          comment: comment,
          elasticity: elasticity,
        };
        return data;
      }
    }

    function calculatePED(derivative, paymentOfGoods1, quantity) {
      // Find PED
      console.log("");
      console.log("####### PED #######");
      var PED_formula = "(d*q / d * p) * p/q";
      console.log(PED_formula);
      console.log(derivative, paymentOfGoods1, quantity);
      var PED_answer_string = `| ${derivative} * (${paymentOfGoods1} / ${quantity}) | `;
      var PED_answer = derivative * (paymentOfGoods1 / quantity),
        PED_answer = Math.abs(PED_answer).toPrecision(2);
      console.log(PED_answer);

      var PED_commentary = checkPED(PED_answer);
      console.log(PED_commentary);
      var PED_Data = {
        PED_answer_string: PED_answer_string,
        PED_formula: PED_formula,
        PED_answer: PED_answer,
        PED_commentary: PED_commentary,
      };
      return PED_Data;
    }
    function if2PED_Calc(expression, paymentOfGoods1, paymentOfGoods2, income) {
      // Finding Q1
      console.log("");
      console.log("##### Finding Q1 #####");
      var p1_replaced = variableReplacer(expression, "p1", paymentOfGoods1),
        p1_p2_replaced = variableReplacer(p1_replaced, "p2", paymentOfGoods2),
        y_p1_p2_replaced = variableReplacer(p1_p2_replaced, "y", income),
        valueOf_Q1 = eval(y_p1_p2_replaced);

      var p2_replaced = variableReplacer(expression, "p2", paymentOfGoods2),
        y_p2_replaced = variableReplacer(p2_replaced, "y", income),
        x_variable = variableReplacer(y_p2_replaced, "p1", "x");

      console.log(y_p1_p2_replaced);
      console.log(valueOf_Q1);

      console.log("");
      console.log("##### Finding Derivation #####");
      // Finding Derivation == (dq1 / dp1 = d/dp1[expression])
      // Keeping p1 varible, other than them, all are constants.
      derivation = deriveExpression(x_variable);
      console.log("Keeping p1 varible, other than them, all are constants.");
      console.log(y_p2_replaced);
      console.log(derivation);

      // Find PED
      PED_Data = calculatePED(derivation, paymentOfGoods1, valueOf_Q1);
      console.log(PED_Data);
      PED_Data2 = [
        {
          name: "Value of Q",
          originalExpression: expression,
          puttingValues: y_p1_p2_replaced,
          answer: valueOf_Q1,
        },
        {
          name: "Derivation of dQ1 / dP1 = d/dp1[expression]",
          formula: `d/dp1[${expression}]`,
          originalExpression: expression,
          note1: "Taking Y and p2 as constants because derivation is of p1",
          puttingValues: y_p2_replaced,
          derivation: derivation,
        },
        {
          name: "PED",
          PED_Data: calculatePED(derivation, paymentOfGoods1, valueOf_Q1),
        },
      ];
      return PED_Data2;
    }
    /////////////////////////////
    // Price Elasticity of Demand
    //////////////////////////////
    function PriceElasticity(
      expression,
      paymentOfGoods1,
      paymentOfGoods2,
      paymentOfGoods3,
      income,
      select_html_Value
    ) {
      // Obtaining the Expression from first Function
      console.log(expression);
      var originalExpression,
        y_replaced_expression,
        d_Q_div_d_p,
        answers,
        valueOf_Q1,
        derivation,
        PED_Data,
        PED_Data2; // Creating variables.

      // select_html_Value means the value of select in the select.
      // If Value is 1
      if (select_html_Value == 1) {
        // Formula
        // PED = | E_d | = | (d_Q / d_p) * p/q|

        // For Deviation
        originalExpression = expression;
        y_replaced_expression = variableReplacer(expression, "y", income);

        // For Q
        /p1/.test(expression)
          ? (expression = variableReplacer(expression, "p1", paymentOfGoods1))
          : (expression = variableReplacer(expression, "p", paymentOfGoods1));
        expression = variableReplacer(expression, "y", income);
        console.log(expression);

        // Getting Q
        var qValue = Q_Checker(expression); // Answer of Q
        console.log(qValue);
        console.log("####### Q End #######");
        console.log("");

        // d_Q_div_d_p
        var expression_derivation = variableReplacer(
          y_replaced_expression,
          "p",
          "x"
        );
        console.log("####### d_Q_div_d_p #######");

        console.log(
          "Since value of Price changes, it won't make a change on Y because it will be the exact amount of sum of Price."
        );
        // Adding Value of Y
        console.log(y_replaced_expression);

        // Taking Deviation
        d_Q_div_d_p = deriveExpression(expression_derivation);
        console.log(d_Q_div_d_p);

        // Putting answers in one bracket
        var d_Q_div_d_p_answer = {
          puttingValues: y_replaced_expression,
          answer: parseFloat(d_Q_div_d_p),
        };

        // Find PED
        PED_Data = calculatePED(
          // d_Q_div_d_p_answer.answer * (paymentOfGoods1 / qValue.answer)
          d_Q_div_d_p_answer.answer,
          paymentOfGoods1,
          qValue.answer
        );
        console.log(PED_Data);
        return (answers = [
          {
            // Q Values
            name: "Q Value",
            originalExpression: originalExpression,
            q_PuttingValues: qValue.puttingValues,
            qValue: qValue.answer,
          },
          {
            // d_Q_div_d_p
            name: "Deviation",
            originalExpression: originalExpression,
            deviation_formula: expression_derivation,
            deviation_PuttingValues: d_Q_div_d_p_answer.puttingValues,
            deviationAnswer: d_Q_div_d_p_answer.answer,
          },
          {
            // PED
            name: "PED",
            PED_answer_string: PED_Data.PED_answer_string,
            ped_PuttingValues: PED_Data.PED_formula,
            ped_answer: PED_Data.PED_answer,
            PED_commentary: PED_Data.PED_commentary,
          },
        ]);
      }

      // If Value is 2
      if (select_html_Value == 2) {
        if2PED_Calc(expression, paymentOfGoods1, paymentOfGoods2, income);
      }

      // If Value is 3
      if (select_html_Value == 3) {
        expression.replace(/p1/g, paymentOfGoods1);
        expression.replace(/p2/g, paymentOfGoods2);
        expression.replace(/p3/g, paymentOfGoods3);
        expression.replace(/y/g, income);
        console.log(expression);
      }

      console.log("-------------------");
    }

    function YED_AND_XED_CHECK(
      select_html_Value,
      PED_Data,
      Y_Value,
      paymentOfGoods1
    ) {
      //
      // Is YED Checked?
      //
      var checkYED = true,
        checkXED = false;
      select_html_Value = select_value;
      console.log("Hurray! :D");
      nerdamer.flush();
      // If value of YED is 1
      if (checkYED == true) {
        document.querySelector("#ped5-yed").style.display = "flex";
        document.querySelector("#ped6-yed").style.display = "flex";

        if (select_html_Value == 1) {
          var YED_OBTAINED_DATA = YEDCalculator(
            PED_Data[0].expression,
            Y_Value,
            PED_Data[1].qValue,
            select_html_Value,
            paymentOfGoods1
          );

          // Heading
          var element = "ped5-yed-h2";
          document.getElementById(element).innerText = "YED";

          // Value 1
          var element = "ped5-yed-1_1";
          var firstNearDream = nerdamer(`${PED_Data[0].originalExpression}`);
          LatexValue("ped5-yed-1", "1", element, "E_y ");

          // Value 2
          element = "ped5-yed-1_2";
          LatexValue_WithoutNerdamer(
            "ped5-yed-1",
            PED_Data[0].q_PuttingValues,
            element,
            `E_y `
          );

          // Value 3
          element = "ped5-yed-1_3";
          LatexValue_WithoutNerdamer(
            "ped5-yed-1",
            PED_Data[0].q_PuttingValues,
            element,
            `E_y `
          );
        }

        // If value of YED is 2
        else if (select_html_Value == 2) {
          console.log("");
          console.log("");
          console.log("Check:DDDDDDDDDDDD");

          document.querySelector("#ped5-yed").style.display = "flex";
          document.querySelector("#ped6-yed").style.display = "flex";
          YEDCalculator(
            PED_Data2[0].originalExpression,
            Y_Value,
            PED_Data2[0].answer,
            select_html_Value,
            paymentOfGoods1
          );

          // Heading
          var element = "ped5-yed-h2";
          document.getElementById(element).innerText = "YED";

          // Value 1
          var element = "ped5-yed-1_1";
          var firstNearDream = nerdamer(`${PED_Data2[0].originalExpression}`);
          LatexValue("ped5-yed-1", "1", element, "E_y ");

          // Value 2
          element = "ped5-yed-1_2";
          LatexValue_WithoutNerdamer(
            "ped5-yed-1",
            PED_Data2[0].puttingValues,
            element,
            `E_y `
          );

          console.log(PED_Data2[0].answer);
          // Value 3
          element = "ped5-yed-1_3";
          LatexValue_WithoutNerdamer(
            "ped5-yed-1",
            PED_Data2[0].answer,
            element,
            `E_y `
          );
        }

        // If value of YED is 3
        else if (select_html_Value == 3) {
          document.querySelector("#ped5-yed").style.display = "flex";
          document.querySelector("#ped6-yed").style.display = "flex";
        } else {
        }
      }
      if (checkXED) {
      }
    }
    function PEDCheck() {
      hideToShow("ped", "flex", 5);
      // Obtaining Expression and Income
      var expression = document
        .getElementById("ped_expression")
        .value.toLowerCase();
      var ped_income = document.getElementById("ped_income").value; // Gets Value of Q

      // Logs The Result
      console.log(expression);
      console.log(ped_income);

      if (select_value == 1) {
        var paymentOfGoods1 = document.getElementById("pg1").value || 0;
      } else if (select_value == 2) {
        var paymentOfGoods1 = document.getElementById("pg1").value || 0;
        var paymentOfGoods2 = document.getElementById("pg2").value || 0;
      } else if (select_value == 3) {
        var paymentOfGoods1 = document.getElementById("pg1").value || 0;
        var paymentOfGoods2 = document.getElementById("pg2").value || 0;
        var paymentOfGoods3 = document.getElementById("pg3").value || 0;
      } else {
        console.log("No value selected, give an error message on display");
      }
      var PED_Data = PriceElasticity(
        expression,
        paymentOfGoods1,
        paymentOfGoods2 || 0,
        paymentOfGoods3 || 0,
        ped_income,
        select_value
      );

      var PED_Data2 = if2PED_Calc(
        expression,
        paymentOfGoods1,
        paymentOfGoods2,
        ped_income
      );

      //
      // PED Display
      //
      function PED_Display() {
        console.log("Hello", PED_Data);
        var select_html_Value = select_value;
        if (select_html_Value == 1) {
          // Find Value of Q
          document.getElementById("ped_find_q").innerHTML =
            "Step 1: Finding Value of Q";

          var element = "ped_calculate_step1_1";
          var firstNearDream = nerdamer(`${PED_Data[0].originalExpression}`);
          LatexValue("ped_calculate_step1", "1", element, "Q ");

          element = "ped_calculate_step1_2";

          LatexValue_WithoutNerdamer(
            "ped_calculate_step1",
            PED_Data[0].q_PuttingValues,
            element,
            `Q `
          );

          element = "ped_calculate_step1_3";

          LatexValue_WithoutNerdamer(
            "ped_calculate_step1",
            PED_Data[0].qValue,
            element,
            `Q `
          );

          // Find Derivative of D_q / DP
          document.getElementById("ped_find_dev").innerHTML =
            "Step 2: Finding Derivative dQ / dP";

          // puttingValues_step1_2
          element = "ped_deviation_1_1";
          var secondNearDream = nerdamer(`${PED_Data[1].deviationAnswer}`);
          LatexValue("ped_deviation_1", "2", element, "dQ / dP ");

          var thirdNearDream = nerdamer();
          LatexValue_WithoutNerdamer(
            "ped_deviation_1",
            `d(${PED_Data[1].originalExpression}) / dP`,
            element,
            "dQ / dP"
          );

          element = "ped_deviation_1_2";
          var thirdNearDream = nerdamer(`${PED_Data[2].ped_PuttingValues}`);
          LatexValue("ped_deviation_1", "2", element, "dQ / dP ");

          // Find Value of PED
          document.getElementById("find_ped").innerHTML =
            "Step 3: Finding Value of PED";

          // (d*q / d * p) * p/q
          var element = "find_ped_1_1";
          nerdamer.flush();

          element = "find_ped_1_1";

          LatexValue_WithoutNerdamer(
            "find_ped_1",
            PED_Data[2].ped_PuttingValues,
            element,
            "PED "
          );

          element = "find_ped_1_2";
          LatexValue_WithoutNerdamer(
            "find_ped_1",
            PED_Data[2].PED_answer_string,
            element,
            "PED "
          );

          element = "find_ped_1_3";
          LatexValue_WithoutNerdamer(
            "find_ped_1",
            PED_Data[2].ped_answer,
            element,
            "PED "
          );

          // Results
          document.getElementById("ped_result_h2").innerHTML = `Result`;
          document.getElementById("ped_deviation_1_3").style.display = "none";

          // Conclusion
          document.getElementById(
            "ped_result_1_1"
          ).innerHTML = `${PED_Data[2].PED_commentary.comment}`;

          document.getElementById(
            "ped_result_1_2"
          ).innerHTML = `${PED_Data[2].PED_commentary.is_Q}`;

          nerdamer.flush();
        }

        // Else Condition
        else if (select_html_Value == 2) {
          // Find Value of Q
          document.getElementById("ped_deviation_1_3").style.display = "flex";
          document.getElementById("ped_find_q").innerHTML =
            "Step 1: Finding Value of Q";

          var element = "ped_calculate_step1_1";
          var firstNearDream = nerdamer(`${PED_Data2[0].originalExpression}`);
          LatexValue("ped_calculate_step1", "1", element, "Q ");

          element = "ped_calculate_step1_2";

          LatexValue_WithoutNerdamer(
            "ped_calculate_step1",
            PED_Data2[0].puttingValues,
            element,
            `Q `
          );

          element = "ped_calculate_step1_3";

          LatexValue_WithoutNerdamer(
            "ped_calculate_step1",
            PED_Data2[0].answer,
            element,
            `Q `
          );

          // Find Derivative of dQ1 / dP1
          document.getElementById("ped_find_dev").innerHTML =
            "Step 2: Finding Derivative dQ1 / dP1";

          // puttingValues_step1_2
          element = "ped_deviation_1_1";
          var secondNearDream = nerdamer(
            `d(${PED_Data2[1].originalExpression}) / dP_1`
          );
          LatexValue("ped_deviation_1", "2", element, "dQ_1/d P_1 ");

          element = "ped_deviation_1_2";
          var secondNearDream = nerdamer(
            `d(${PED_Data2[1].puttingValues}) / dP_1`
          );
          LatexValue("ped_deviation_1", "3", element, "dQ_1/d P_1 ");

          element = "ped_deviation_1_3";
          var thirdNearDream = nerdamer(`${PED_Data2[1].derivation}`);
          LatexValue("ped_deviation_1", "4", element, "dQ_1/d P_1 ");

          // Find Value of PED
          document.getElementById("find_ped").innerHTML =
            "Step 3: Finding Value of PED";

          // (d*q / d * p) * p/q
          var element = "find_ped_1_1";
          nerdamer.flush();

          element = "find_ped_1_1";

          var thirdNearDream = nerdamer(`dQ_1/dP_1 * p/q`);
          LatexValue("find_ped_1", "1", element, "PED ");

          element = "find_ped_1_2";
          LatexValue_WithoutNerdamer(
            "find_ped_1",
            PED_Data2[2].PED_Data.PED_answer_string,
            element,
            "PED "
          );

          element = "find_ped_1_3";
          LatexValue_WithoutNerdamer(
            "find_ped_1",
            PED_Data2[2].PED_Data.PED_answer,
            element,
            "PED "
          );

          // Results
          document.getElementById("ped_result_h2").innerHTML = `Result`;

          // Conclusion
          document.getElementById(
            "ped_result_1_1"
          ).innerHTML = `${PED_Data2[2].PED_Data.PED_commentary.comment}`;

          document.getElementById(
            "ped_result_1_2"
          ).innerHTML = `${PED_Data2[2].PED_Data.PED_commentary.is_Q}`;

          nerdamer.flush();
        } else if (select_html_Value == 3) {
          // Find Value of Q
          document.getElementById("ped_find_q").innerHTML =
            "Step 1: Finding Value of Q";

          var element = "ped_calculate_step1_1";
          var firstNearDream = nerdamer(`${PED_Data[0].originalExpression}`);
          LatexValue("ped_calculate_step1", "1", element, "Q ");

          element = "ped_calculate_step1_2";

          LatexValue_WithoutNerdamer(
            "ped_calculate_step1",
            PED_Data[0].q_PuttingValues,
            element,
            `Q `
          );

          element = "ped_calculate_step1_3";

          LatexValue_WithoutNerdamer(
            "ped_calculate_step1",
            PED_Data[0].qValue,
            element,
            `Q `
          );

          // Find Derivative of D_q / DP
          document.getElementById("ped_find_dev").innerHTML =
            "Step 2: Finding Derivative dQ / dP";

          // puttingValues_step1_2
          element = "ped_deviation_1_1";
          var secondNearDream = nerdamer(`${PED_Data[1].deviationAnswer}`);
          LatexValue("ped_deviation_1", "2", element, "dQ / dP ");

          element = "ped_deviation_1_2";
          var secondNearDream = nerdamer(
            `d(${PED_Data[1].originalExpression})\div dP`
          );
          LatexValue("ped_deviation_1", "3", element, "dQ / dP ");

          element = "ped_deviation_1_2";
          var secondNearDream = nerdamer(`${PED_Data[2].ped_PuttingValues}`);
          LatexValue("ped_deviation_1", "4", element, "dQ / dP ");

          // Find Value of PED
          document.getElementById("find_ped").innerHTML =
            "Step 3: Finding Value of PED";

          // (d*q / d * p) * p/q
          var element = "find_ped_1_1";
          nerdamer.flush();

          element = "find_ped_1_1";

          LatexValue_WithoutNerdamer(
            "find_ped_1",
            PED_Data[2].ped_PuttingValues,
            element,
            "PED "
          );

          element = "find_ped_1_2";
          LatexValue_WithoutNerdamer(
            "find_ped_1",
            PED_Data[2].PED_answer_string,
            element,
            "PED "
          );

          element = "find_ped_1_3";
          LatexValue_WithoutNerdamer(
            "find_ped_1",
            PED_Data[2].ped_answer,
            element,
            "PED "
          );

          // Results
          document.getElementById("ped_result_h2").innerHTML = `Result`;

          // Conclusion
          document.getElementById(
            "ped_result_1_1"
          ).innerHTML = `${PED_Data[2].PED_commentary.comment}`;
          console.log(select_html_Value);
          document.getElementById(
            "ped_result_1_2"
          ).innerHTML = `${PED_Data[2].PED_commentary.is_Q}`;
          console.log(select_html_Value);
          nerdamer.flush();
        }
        YED_AND_XED_CHECK(select_value, PED_Data);
      }
      // Function that displays values on HTML page
      try {
        PED_Display(select_value);
      } catch (error) {
        document.getElementById("result").innerHTML =
          "There is some issue in the formula or the typed data is invalid";
        console.log(error);
      }
    }
  </script>
  <!-- YED Calculator -->
  <script>
    //////
    // YED
    //////
    function YEDCalculator(
      expression,
      y,
      q,
      selectPriceValue,
      paymentOfGoods1
    ) {
      var YED = "(d*q / d * p) * y/q";

      // If YED value is 1
      if (selectPriceValue == 1) {
        // Derivative
        // Formula = dQ/dY = (d/dy) [expression]
        var newcomment = "Considering Price as constant",
          p_constant = variableReplacer(expression, "p", paymentOfGoods1 || 1),
          q_variable = variableReplacer(p_constant, "y", "x"),
          derivative = deriveExpression(q_variable);

        console.log(YED);
        console.log(newcomment);
        console.log(p_constant);
        console.log(q_variable);
        console.log(derivative);
      }

      // If YED value is 2
      else if (selectPriceValue == 2) {
        // Derivative
        // Formula = dQ/dY = (d/dy) [expression]
        var newcomment = "Considering Prices as constant",
          q_variable = variableReplacer(expression, "y", "x"),
          derivative = deriveExpression(q_variable);

        console.log(YED);
        console.log(newcomment);
        console.log(q_variable);
        console.log(derivative);
        console.log("");
      }

      // If YED value is 3
      else if (selectPriceValue == 3) {
      } else {
        console.log("Please enter a valid number");
      }

      // Formula = (d*q / d*p) * y/q
      console.log("Putting Values of Derivative");
      console.log(YED);
      var putting_values = variableReplacer(YED, "(d*q / d * p)", derivative);
      console.log(putting_values);

      YED = derivative * (y / q);
      YED = YED.toPrecision(2);
      console.log(YED);
      var answer = checkYED(YED);
      console.log(answer);

      var YED_Data = {
        expression: expression,
        note: "Replaced values of q",
        q_variable: q_variable, // Repleaced Data
        putting_values: putting_values,
        derivative: YED,
        comments: answer,
      };

      return YED_Data;
    }
  </script>
  <!-- XED Calculator -->
  <script>
    /////////////////
    // XED Calculator
    /////////////////
    function XEDCalculator(expression, p2, q1, selectPriceValue) {
      var XED = "(d*q / d * p) * y/q";
      if (selectPriceValue == 1) {
        // Derivative
        // Formula = dQ1/dp2 = (d/dp2) [expression]
        var newcomment = "Considering Price 2 as variable",
          q_variable = variableReplacer(expression, "p2", "x"),
          derivative = deriveExpression(q_variable);

        console.log(XED);
        console.log(newcomment);
        console.log(p_constant);
        console.log(q_variable);
        console.log(derivative);
      } else if (selectPriceValue == 2) {
        // Derivative
        // Formula = dQ1/dp2 = (d/dp2) [expression]
        var newcomment = "Considering Prices as constant",
          q_variable = variableReplacer(expression, "p2", "x"),
          derivative = deriveExpression(q_variable);

        console.log(XED);
        console.log(newcomment);
        console.log(q_variable);
        console.log(derivative);
        console.log("");
      } else if (selectPriceValue == 3) {
      } else {
        console.log("Please enter a valid number");
      }
      // Formula = (d*q / d*p) * y/q
      console.log("Putting Values of Derivative");
      console.log(XED);
      var putting_values = variableReplacer(XED, "(d*q / d * p)", derivative);
      console.log(putting_values);

      XED = derivative * (p2 / q1);
      XED = XED.toPrecision(2);
      console.log(XED);
      var answer = checkYED(XED);
      console.log(answer);
    }
  </script>
  <script>
    function ChangeCalculator(quantity_demand, price, percentChange) {
      var data = (price / quantity_demand) * percentChange;
      console.log(data + "% Change");
      return data;
    }

    ////////
    // Tests
    ////////
    // PED
    // var Expressive = "700-2*p+0.02*y",
    // var Expressive = "4850 - 5 * p1 + 1.5 * p2 + 0.1 * y",
    //   p = "200" || 0,
    //   p1 = p,
    //   p2 = "100" || 0,
    //   p3 = "478" || 0,
    //   income = "5000",
    // PriceElasticity(Expressive, p1, p2, p3, income);
    // expression = Expressive.toLowerCase();
    // console.log(PriceElasticity(expression, p1, p2, p3, income, 2));
    // console.log(PriceElasticity(expression, p1, p2, p3, income, 2));

    // YED
    // var y = 25,
    //   q = 750;
    // var y = 10000,
    //   q = 5000;

    // YEDCalculator("700-2*p+0.02*y", y, q, 1);
    // YEDCalculator(Expressive, y, q, 2);
    // XEDCalculator(expression, p2, q, 2);

    // ChangeCalculator(q, p2, 10);
    // Use css selector:after to say number and use `%` in selector.
  </script>

  <!--  -->
  <!--  -->
  <!--  -->
  <!--  -->
  <!--  -->
  <!--  -->
  <!--  -->

  <script>
    // Unhiding Answers
    document.querySelector("#students_tab_1").style.display = "flex";
    document.querySelector("#students_tab_2").style.display = "flex";
    document.querySelector("#students_tab_3").style.display = "flex";
    document.querySelector("#students_tab_4").style.display = "flex";
    document.querySelector("#students_tab_5").style.display = "flex";

    // Scripts for the students
    // # Part 1_1
    // ## Finding Q1
    // q1 = expression (putting p1, p2, p3, y)
    // q1 = answer
    function StudentValuesCheck() {
      var expression =
          document.querySelector("#student_expression").value.toLowerCase() ||
          0,
        p1 = document.querySelector("#pog1").value || 0,
        p2 = document.querySelector("#pog2").value || 0,
        p3 = document.querySelector("#pog3").value || 0,
        y = document.querySelector("#student_income").value || 0;
      console.log("P1 = " + p1 + "\n P2 = " + p2);
      console.log("##### Finding Q #####");
      var q_replaced = variableReplacer(
        expression,
        "p1",
        p1,
        "p2",
        p2,
        "p3",
        p3,
        "y",
        y
      );
      var qValue = Q_Checker(q_replaced); // Answer of Q
      console.log(qValue);

      // # Part 1
      // ## Finding PED
      // ped = dq1/dp1 x p1/q1
      // Formula == (dq1 / dp1 = d/dp1[expression])
      document.getElementById("part_1_PED_h2").innerHTML =
        "<h2>Price Elasticity of Demand (PED)</h2>";
      document.getElementById(
        "part_1_PED-1-1"
      ).innerHTML = `<h3>Formula</h3> dq1/dp1 x p1/q1`;

      console.log("");
      console.log("");
      console.log("##### Finding PED #####");
      console.log("##### Finding Derivation #####");
      console.log("Keeping p1 varible, other than them, all are constants.");
      var p2_p3_y_replaced = variableReplacer(
        expression,
        "p2",
        p2,
        "p3",
        p3,
        "y",
        y
      );
      var p1_replaced = variableReplacer(p2_p3_y_replaced, "p1", "x");
      var derivation = deriveExpression(p1_replaced);
      console.log(p1_replaced);
      console.log(derivation);
      console.log("");

      // Results
      document.getElementById(
        "part_1_PED-1-2"
      ).innerHTML = `<h3 class="px-10-u">Finding Q</h3>`;
      document.getElementById(
        "part_1_PED-1-3"
      ).innerHTML = `Q1 = ${expression}`;
      document.getElementById(
        "part_1_PED-1-4"
      ).innerHTML = `Placing all the values in the formula`;
      // document.getElementById("part_1_PED-1-5").innerHTML = `Q = ${expression}`;
      document.getElementById(
        "part_1_PED-1-6"
      ).innerHTML = `Q = ${qValue.puttingValues}`;
      document.getElementById(
        "part_1_PED-1-7"
      ).innerHTML = `Q = ${qValue.answer}`;

      // so putting derivate in ped
      console.log("##### Part 2 #####");
      console.log("ped = derivate x p1/q1");
      console.log(`ped = ${derivation} x ${p1}/${qValue.answer}`);
      var answer = `${(derivation * (p1 / qValue.answer)).toPrecision(2)}`;
      console.log(`ped = ${answer}`);

      // Results
      document.getElementById("part_1_PED-1-8").innerHTML = `
      <p>Now we have obtained Q, finding derivative.</p>
      <h3> Finding Derivation </h3>
      <p>dq1/dp1 = d/dp1 (${expression})</p>
      <p>Adding Values</p>
      <p>dq1/dp1 = d/dp1 (${p2_p3_y_replaced})</p>
      <p>dq1/dp1 = ${derivation}</p>
      `;
      document.getElementById(
        "part_1_PED-1-9"
      ).innerHTML = `<h3 class='px-10-u'>Finding PED</h3> <p>PED = dq1/dp1 x p1/q1 </p>ped = ${derivation} x ${p1}/${qValue.answer}`;
      document.getElementById(
        "part_1_PED-1-10"
      ).innerHTML = `Placing all the values in the formula, we get.`;
      document.getElementById(
        "part_1_PED-1-11"
      ).innerHTML = `<h4>Answer</h4>PED = ${Math.abs(answer)}`;

      // Part 2
      // Finding Income of Elasticity
      console.log("");
      console.log("");
      console.log("##### Finding Income of Elasticity #####");
      console.log("##### Finding Derivation #####");
      console.log("Keeping y varible, other than them, all are constants.");

      var p1_p2_p3_replaced = variableReplacer(
        expression,
        "p1",
        p1,
        "p2",
        p2,
        "p3",
        p3
      );
      var y_replaced = variableReplacer(p1_p2_p3_replaced, "y", "x");
      var derivation = deriveExpression(y_replaced);
      console.log(y_replaced);
      console.log(derivation);
      console.log("");

      // so putting derivate in ped
      console.log("##### Part 2 #####");
      console.log("yed = derivate x y/q1");
      console.log(`yed = ${derivation} x ${y}/${qValue.answer}`);
      console.log(`yed = ${((derivation * y) / qValue.answer).toPrecision(2)}`);

      // Results
      document.getElementById(
        "part_2_YED_h2"
      ).innerHTML = `<h2 class='px-10-u'>Income Elasticity of Demand (YED)</h2>`;
      document.getElementById(
        "part_2_YED-1-1"
      ).innerHTML = `<h3 class='px-10-u'>Formula</h3>
          <p>YED = dq1/dy x y/q1</p>
            <h3 class='px-10-u'>Finding Derivation</h3>`;
      document.getElementById(
        "part_2_YED-1-2"
      ).innerHTML = `Taking Derivation from Y`;
      document.getElementById(
        "part_2_YED-1-3"
      ).innerHTML = `dq1/dy = d/dy (${expression})`;
      document.getElementById(
        "part_2_YED-1-4"
      ).innerHTML = `dq1/dy = ${derivation}`;

      // Results
      document.getElementById(
        "part_2_YED-1-5"
      ).innerHTML = `<h3 class='px-10-u'>Placing Values in YED</h3>`;
      // document.getElementById("part_2_YED-1-6").innerHTML ="<h3>Finding Derivation</h3>";
      document.getElementById(
        "part_2_YED-1-7"
      ).innerHTML = `We know, <b>YED = dq1/dy x y/q1</b>, so`;
      document.getElementById(
        "part_2_YED-1-8"
      ).innerHTML = `YED = ${derivation} x ${y}/${qValue.answer}`;
      document.getElementById(
        "part_2_YED-1-9"
      ).innerHTML = `<h4>Answer</h4> YED = ${(
        (derivation * y) /
        qValue.answer
      ).toPrecision(2)}`;
      console.log("");
      console.log("");
      console.log("");

      // ## Finding values
      function checkGood(goods) {
        var goodsTest =
          goods == "good 1" ? "p1" : goods == "good 2" ? "p2" : "p3";
        var failedtest1,
          failedtest2,
          failedTestVariable1,
          failedTestVariable2,
          successVariable;
        if (goodsTest == "p1") {
          failedtest1 = "p2";
          failedtest2 = "p3";
          successVariable = p1;
          failedTestVariable1 = p2;
          failedTestVariable2 = p3;
        } else if (goodsTest == "p2") {
          failedtest1 = "p1";
          failedtest2 = "p3";
          failedTestVariable1 = p1;
          successVariable = p2;
          failedTestVariable2 = p3;
        } else if (goodsTest == "p3") {
          failedtest1 = "p1";
          failedtest2 = "p2";
          failedTestVariable1 = p1;
          failedTestVariable2 = p2;
          successVariable = p3;
        }
        var Data = {
          goodsTest: goodsTest,
          failedtest1: failedtest1,
          failedtest2: failedtest2,
          failedTestVariable1: failedTestVariable1,
          failedTestVariable2: failedTestVariable2,
          successVariable: successVariable,
          name: goods,
        };
        return Data;
      }

      // ## Finding cross price between two things
      function crossPriceFinder(good1, good2, expression, p2, qValue) {
        good2 = checkGood(good2).goodsTest;
        var failedtest1 = checkGood(good2).failedtest1,
          failedtest2 = checkGood(good2).failedtest2,
          failedTestVariable1 = checkGood(good2).failedTestVariable1,
          failedTestVariable2 = checkGood(good2).failedTestVariable2,
          successVariable = checkGood(good2).successVariable;

        // good 1 and good 2 = dq1 / dp2 x p2/q1
        console.log("##### Cross Price #####");
        console.log("##### Finding Derivation #####");
        var formula = `${good1} and ${good2} = dq1 / d${good2} x ${good2}/q1`;
        console.log(formula);
        console.log("Keeping p2 varible, other than them, all are constants.");

        // Calculation
        var p2_replaced = variableReplacer(expression, good2, "x");
        var derivation = deriveExpression(p2_replaced);

        // Results
        console.log(p2_replaced);
        console.log(derivation);

        // Putting Values for XED
        console.log("##### Putting Values #####");
        var XED = `XED = derivate x ${good2}/q1`;
        var XED_Putting_Values = `XED = ${derivation} x ${p2}/${qValue}`;
        var XED_answer = `<h4>Answer</h4>XED = ${(
          (derivation * p2) /
          qValue
        ).toPrecision(2)}`;
        console.log(XED);
        console.log(XED_Putting_Values);
        console.log(`XED = ${answer}`);

        // Results
        if (good2 == "p2") {
          // Finding Derivation
          document.getElementById(
            "part_3_XED_h2"
          ).innerHTML = `<h2>Cross Price Elasticity of Demand (XED)</h2>
          <p>Checking Between Good 1 and Good 2</p>
          XED = dq1 / d${good2} x ${good2}/q1`;
          document.getElementById("part_3_XED_1").innerHTML =
            "<h3 class='px-10-u'>Finding Derivation</h3>";
          document.getElementById(
            "part_3_XED_2"
          ).innerHTML = `dq1 / d${good2} = d/d${good2} (${expression}) `;
          document.getElementById(
            "part_3_XED_3"
          ).innerHTML = `Placing all the values in the formula and taking derivation, we get.`;
          document.getElementById(
            "part_3_XED_4"
          ).innerHTML = `dq1 / ${good2} = ${derivation}`;
          document.getElementById(
            "part_3_XED_5"
          ).innerHTML = `<h3 class='px-10-u'>Finding XED</h3>`;

          // Finding XED
          document.getElementById("part_3_XED_6").innerHTML = XED;
          document.getElementById("part_3_XED_7").innerHTML =
            XED_Putting_Values;
          document.getElementById("part_3_XED_8").innerHTML = XED_answer;
        }
        //
        // If P1 and P3
        //
        else {
          // Finding Derivation
          document.getElementById(
            "part_4_XED_h2"
          ).innerHTML = `<h2>Cross Price Elasticity of Demand (XED)</h2>
          <p> Checking Between Good 1 and Good 3 </p>
          XED = dq1 / d${good2} x ${good2}/q1`;
          document.getElementById("part_4_XED_1").innerHTML =
            "<h3 class='px-10-u'>Finding Derivation</h3>";
          document.getElementById(
            "part_4_XED_2"
          ).innerHTML = `dq1 / d${good2} = d/d${good2} (${expression}) `;
          document.getElementById(
            "part_4_XED_3"
          ).innerHTML = `Placing all the values in the formula and taking derivation, we get.`;
          document.getElementById(
            "part_4_XED_4"
          ).innerHTML = `dq1 / ${good2} = ${derivation}`;
          document.getElementById(
            "part_4_XED_5"
          ).innerHTML = `<h3 class='px-10-u'>Finding XED</h3>`;

          // Finding XED
          document.getElementById("part_4_XED_6").innerHTML = XED;
          document.getElementById("part_4_XED_7").innerHTML =
            XED_Putting_Values;
          document.getElementById("part_4_XED_8").innerHTML = XED_answer;
        }

        return answer;
      }
      // Part 3
      var price2 = crossPriceFinder(
        "good 1",
        "good 2",
        expression,
        p2,
        qValue.answer
      );
      console.log("");
      console.log("");
      console.log("");

      // Part 4
      var price2 = crossPriceFinder(
        "good 1",
        "good 3",
        expression,
        p3,
        qValue.answer
      );

      // Part 5
      function percentChange(good1, good2, percentValue, decreaseOrIncrease) {
        good1Name = good1.toLowerCase();
        good2Name = good2.toLowerCase();

        // Percentage Change

        // # Since change in goods 3 and goods 1 price is decrease by 5%, it is -5
        if (decreaseOrIncrease == "+") {
          var percentChangeP1 = "+" + percentValue;
          decreaseOrIncrease = "increase";
        } else {
          var percentChangeP1 = "-" + percentValue;
          decreaseOrIncrease = "decrease";
        }
        var goodsTest = checkGood(good2).goodsTest;
        good2 = checkGood(good2).goodsTest;
        var failedtest1 = checkGood(good2).failedtest1,
          failedtest2 = checkGood(good2).failedtest2,
          failedTestVariable1 = checkGood(good2).failedTestVariable1,
          failedTestVariable2 = checkGood(good2).failedTestVariable2,
          successVariable = checkGood(good2).successVariable,
          goods = checkGood(good2).name;

        // PED for good 1 and good 3, decrease by 5% in price of goods 3
        var check = `PED for ${good1} and ${good2Name}, ${decreaseOrIncrease} by ${percentValue}% in price of ${good2Name}`;

        // Taking derivation
        console.log("");
        console.log("");
        console.log("##### Finding Derivation #####");

        var p2_p3_y_replaced = variableReplacer(
          expression,
          failedtest1,
          failedTestVariable1,
          failedtest2,
          failedTestVariable2,
          "y",
          y
        );
        console.log(p2_p3_y_replaced);
        var p1_replaced = variableReplacer(p2_p3_y_replaced, goodsTest, "x");
        var derivation = deriveExpression(p1_replaced);
        console.log(
          `Keeping ${goodsTest} varible, other than them, all are constants.`
        );
        console.log(p1_replaced);
        console.log(derivation);
        console.log("");

        // so putting derivate in ped
        console.log("##### Part 2 #####");
        var formula = `xed = derivate x ${goodsTest}/q1`;
        var putting_Values = `xed = ${derivation} x ${goodsTest}/${qValue.answer}`;
        console.log(formula);
        console.log(putting_Values);
        var answer = (
          (derivation * successVariable) /
          qValue.answer
        ).toPrecision(2);
        console.log(`xed = ${answer}`);

        console.log("");
        console.log("");
        console.log("");

        // # Taken from Part 4, cross price of good 1 and good 3
        // cross ped good 1 and good 3 = -0.08
        var xed = answer;
        console.log("Cross Price Value = " + xed);
        // xed = % change in q1 / % change in p1
        // so
        // % change in q1 = percent change x cross price
        var percentChangeQ1 = eval(percentChangeP1 * xed);
        console.log(`percentChangeQ1 = ${percentChangeQ1.toPrecision(2)}`);

        // Results
        document.getElementById("part_5_percent_change_h2").innerHTML =
          "<h2>Percent Change<h2>";

        document.getElementById("part_5_percent_change_1").innerHTML = check;

        document.getElementById(
          "part_5_percent_change_2"
        ).innerHTML = `<h3 class='px-10-u'>Finding Derivation</h3>`;
        document.getElementById(
          "part_5_percent_change_3"
        ).innerHTML = `${expression}`;
        document.getElementById(
          "part_5_percent_change_4"
        ).innerHTML = `Putting Values`;
        document.getElementById(
          "part_5_percent_change_5"
        ).innerHTML = `dq1/d${goodsTest} = d/d${goodsTest} (${expression})`;
        document.getElementById(
          "part_5_percent_change_6"
        ).innerHTML = `dq1/d${goodsTest} = ${derivation}`;

        // Results
        document.getElementById(
          "part_5_percent_change_7"
        ).innerHTML = `<h3 class='px-10-u'>Finding Cross Price Value</h3>`;
        document.getElementById(
          "part_5_percent_change_8"
        ).innerHTML = `We know, XED = dq1/d${goodsTest} x ${goodsTest}/q1`;
        document.getElementById(
          "part_5_percent_change_9"
        ).innerHTML = `XED = ${answer}`;

        // Results
        document.getElementById(
          "part_5_percent_change_10"
        ).innerHTML = `<h3 class='px-10-u'>Finding Percent of Change</h3><h4>Formula</h4> PoC = % Change in Q1 / % Change in ${goodsTest}`;
        var percent = document.getElementById("percent").value;
        var operator = document.getElementById("decreaseOrIncrease").value;

        document.getElementById(
          "part_5_percent_change_11"
        ).innerHTML = `<p>Placing Values</p>% Change in Q1 = ${parseFloat(
          answer
        ).toPrecision(2)} * ${operator}${percent}`;

        var answer = eval(answer * (operator + percent)).toPrecision(2);
        document.getElementById(
          "part_5_percent_change_12"
        ).innerHTML = `<h4>Answer</h4>% Change in Q1 = ${answer}`;
        // PED for good 1 and good 3, decrease by 5% in price of goods 3
        // var check = `PED for ${good1} and ${good2Name}, ${decreaseOrIncrease} by ${percentValue}% in price of ${good2Name}`;
        var decreaseOrIncrease = document
          .getElementById("decreaseOrIncrease")
          .innerText.toLowerCase();
        good2 = document.getElementById("good2").value;
        document.getElementById(
          "part_5_percent_change_13"
        ).innerHTML = `Therefore, the percentage change in quanitity of good is %${answer}. Which means that the price of ${good2} ${
          Math.sign(answer) == -1 ? "increases" : "decreases"
        } by %${percentValue}. The quanitity demanded of ${good1} ${
          Math.sign(answer) == -1 ? "decreases" : "increases"
        } by %${answer}`;
        console.log("Hello");
      }

      console.log("Good 1 and Good 3");
      var good1 = document.getElementById("good1").value,
        good2 = document.getElementById("good2").value,
        percent = document.getElementById("percent").value,
        operator = document.getElementById("decreaseOrIncrease").value;
      percentChange(good1, good2, percent, decreaseOrIncrease);
      console.log("");
      console.log("");
    }
  </script>
</html>
