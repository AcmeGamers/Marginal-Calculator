<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Marginal Calculator</title>
    <link rel="stylesheet" href="app.css" />
    <link rel="stylesheet" href="components/tabs.css" />
  </head>
  <body>
    <div id="tabs">
      <h2>Tabs</h2>

      <div class="tab">
        <button class="tablinks" onclick="openCity(event, 'London')">
          Marginal Calculator
        </button>
        <button class="tablinks" onclick="openCity(event, 'Paris')">
          Paris
        </button>
        <button class="tablinks" onclick="openCity(event, 'Tokyo')">
          Tokyo
        </button>
      </div>

      <div id="London" class="tabcontent">
        <input
          type="text"
          placeholder="Expression"
          value="49 + 8*x + 6*x^2"
          id="expression"
        />
        <input type="text" placeholder="Value of Q" value="9" id="q_value" />
        <input value="Calculate!" type="button" onclick="inputCheck()" />

        <div class="left-align">
          <h2 id="derivation_h2"></h2>
          <p id="derivative_step1" class="hide"></p>
          <p id="derivative_step1_2"></p>
          <p id="derivative_step2" class="hide"></p>
          <p id="derivative_step2_2"></p>
        </div>

        <div class="left-align">
          <h2 id="puttingValues_h2"></h2>
          <p id="puttingValues_step1" class="hide"></p>
          <p id="puttingValues_step1_2"></p>
          <p id="puttingValues_step2" class="hide"></p>
          <p id="puttingValues_step2_2"></p>
          <span id="result"></span>
        </div>
      </div>

      <div id="Paris" class="tabcontent">
        <h3>Paris</h3>
        <p>Paris is the capital of France.</p>
      </div>

      <div id="Tokyo" class="tabcontent">
        <h3>Tokyo</h3>
        <p>Tokyo is the capital of Japan.</p>
      </div>
    </div>
  </body>

  <!-- Nerdamer -->

  <script src="https://cdn.jsdelivr.net/npm/nerdamer@1.1.12/nerdamer.core.min.js"></script>
  <script
    src="https://cdn.jsdelivr.net/npm/nerdamer@1.1.12/Algebra.js"
    integrity="sha256-oJEHFFp8pDXx0Myx6cc7RVmh3a2kZPEGOP+bAunJptU="
    crossorigin="anonymous"
  ></script>
  <script
    src="https://cdn.jsdelivr.net/npm/nerdamer@1.1.12/Calculus.js"
    integrity="sha256-1X0hl2yReR/yZuZo7R3A9LUgS9+zWl8GzYjuk4pd6bE="
    crossorigin="anonymous"
  ></script>

  <!-- Katex -->
  <link
    rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css"
    integrity="sha384-R4558gYOUz8mP9YWpZJjofhk+zx0AS11p36HnD2ZKj/6JR5z27gSSULCNHIRReVs"
    crossorigin="anonymous"
  />

  <!-- The loading of KaTeX is deferred to speed up page rendering -->
  <script
    defer
    src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js"
    integrity="sha384-z1fJDqw8ZApjGO3/unPWUPsIymfsJmyrDVWC8Tv/a1HeOtGmkwNd/7xUS0Xcnvsx"
    crossorigin="anonymous"
  ></script>

  <!-- To automatically render math in text elements, include the auto-render extension: -->
  <script
    defer
    src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/contrib/auto-render.min.js"
    integrity="sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR"
    crossorigin="anonymous"
    onload="renderMathInElement(document.body);"
  ></script>

  <!-- My Scripts -->
  <script src="altogether.js"></script>
  <script>
    function openCity(evt, cityName) {
      var i, tabcontent, tablinks;
      tabcontent = document.getElementsByClassName("tabcontent");
      for (i = 0; i < tabcontent.length; i++) {
        tabcontent[i].style.display = "none";
      }
      tablinks = document.getElementsByClassName("tablinks");
      for (i = 0; i < tablinks.length; i++) {
        tablinks[i].className = tablinks[i].className.replace(" active", "");
      }
      document.getElementById(cityName).style.display = "block";
      evt.currentTarget.className += " active";
    }
  </script>

  <!-- Custom Scripts  -->
  <script>
    function inputCheck() {
      console.log("check");
      var expression = document.getElementById("expression").value;
      var q_value = document.getElementById("q_value").value;

      // Latex Function
      function LatexValue(id, nerdamerExpression, TheElement, data) {
        document.getElementById(id).innerHTML = katex.render(
          data +
            `=  ${nerdamer.expressions(true, "LaTeX")[nerdamerExpression]}`,
          document.getElementById(TheElement),
          {
            displayMode: true,
            macros: {
              "\\RR": "\\mathbb{R}",
            },
          }
        );
      }

      // Starting Function
      try {
        var result = MarginalRevenue(expression, q_value);

        // Derivation
        document.getElementById("derivation_h2").innerHTML =
          "Step 1: Derivation";

        var element = "derivative_step1_2";
        var firstNearDream = nerdamer(`d/dq(${expression})`);
        LatexValue("derivative_step1", "1", element, "MC ");

        element = "derivative_step2_2";
        var secondNearDream = nerdamer(`${result.derivative}`);
        LatexValue("derivative_step2", "2", element, "MC ");

        // Putting Values
        document.getElementById("puttingValues_h2").innerHTML =
          "Step 2: Putting Values";
        // puttingValues_step2_2
        element = "puttingValues_step1_2";
        var secondNearDream = nerdamer(`${q_value}`);
        LatexValue("puttingValues_step1", "3", element, "Value of Q");

        document.getElementById("puttingValues_step2").innerHTML =
          result.puttingValues;

        // Results
        document.getElementById(
          "result"
        ).innerHTML = `Marginal Revenue = ${result.answer}`;
      } catch (error) {
        document.getElementById("result").innerHTML =
          "There is some issue in the formula or the typed data is invalid";
        console.log(error);
      }
    }
  </script>
</html>
